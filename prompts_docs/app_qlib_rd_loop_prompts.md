# 应用层：Qlib R&D 循环 (Qlib RD Loop) 提示词

本文档概述定义在 `rdagent/app/qlib_rd_loop/prompts.yaml` 文件中的提示词。这些提示词是为 `rdagent/app/qlib_rd_loop/` 应用（一个基于Qlib平台的自动化因子挖掘和模型优化循环）的特定需求而设计的。

**与场景层提示词的关系**:

Qlib场景的核心提示词（如因子/模型假设生成、实验设计、反馈分析等）主要定义在 `rdagent/scenarios/qlib/prompts.yaml` (见 [`prompts_docs/scenarios_qlib_prompts.md`](scenarios_qlib_prompts.md))。而 `app/qlib_rd_loop/prompts.yaml` 中的提示词，更可能是为了编排和驱动这个特定**应用**的整体R&D循环，或者处理一些该应用独有的、更高层次的决策或用户交互。

## 提示词概览 (通用预期)

-   **源文件路径**: `rdagent/app/qlib_rd_loop/prompts.yaml`

-   **主要用途 (基于应用层循环的推测)**:
    -   **循环启动与配置解读**: (可能) 包含用于理解用户对整个R&D循环的初始配置或目标的提示词。
    -   **宏观策略决策**: 指导 LLM 在多次迭代后，对整体策略进行调整（例如，在因子挖掘和模型优化之间切换重点，调整探索与利用的平衡，决定何时终止循环等）。
    -   **结果汇总与报告生成**: (可能) 在多轮迭代结束后，对整个过程的成果（例如，发现的最优因子组合、最佳模型配置、累计收益等）进行汇总，并生成最终报告。
    -   **用户交互辅助**: (如果应用包含用户交互界面) 可能包含用于解析用户输入、生成对用户问题的回复或解释当前进展的提示词。
    -   **与 `RDLoop` 基类的配合**: `rdagent/app/qlib_rd_loop/` 下的Python代码（如 `quant.py`, `factor.py`, `model.py`）可能实现了 `RDLoop` 的某些步骤，这些步骤的LLM调用会使用此处的提示词。

-   **关键输入变量 (通用预期)**:
    -   `{{ overall_trace_summary }}`: 对整个历史轨迹 (`Trace`) 的高度概括。
    -   `{{ current_loop_status }}`: 当前R&D循环的状态信息（例如，已运行轮数、当前SOTA性能、资源消耗等）。
    -   `{{ user_defined_goals }}`: (可选) 用户设定的本次R&D任务的总体目标。
    -   `{{ available_actions_or_strategies }}`: (可选) 当前可供选择的宏观策略或行动选项。

-   **输出格式要求**:
    -   可能是对下一步宏观策略的决策（例如，JSON对象指明下一阶段重点）。
    -   可能是自然语言的总结报告或对用户的建议。

-   **在流程中的位置**:
    -   这些提示词主要由 `rdagent/app/qlib_rd_loop/` 下的Python逻辑（例如，`RDLoop` 的特定实现或其编排逻辑）在每个R&D大循环的关键决策点或在整个任务结束时调用。

-   **设计说明**:
    -   与场景层提示词相比，应用层提示词可能更侧重于“元认知”或更高层次的策略控制，而不是具体的因子/模型细节生成。
    -   它们需要整合来自多个迭代周期的信息，进行更长期的规划。

**建议的进一步分析**:

要准确理解这些提示词的作用，需要：
1.  仔细阅读 `rdagent/app/qlib_rd_loop/prompts.yaml` 的源文件内容。
2.  分析 `rdagent/app/qlib_rd_loop/` 目录下的Python代码（特别是循环控制和主要业务逻辑文件），找出这些提示词是如何被调用的，以及它们的输入是如何构建的，输出是如何被使用的。
3.  将其与 `rdagent/scenarios/qlib/prompts.yaml` 中的提示词进行对比，明确它们在不同抽象层级上的分工。

**注意**: 此文档提供的是对该路径下提示词用途的通用预期。具体提示词条目和内容需查阅源文件。
